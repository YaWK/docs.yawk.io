<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YaWK: YAWK\update Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="new_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Abel&family=Roboto+Serif:wght@300&display=swap" rel="stylesheet">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">YaWK
   &#160;<span id="projectnumber">23.3</span>
   </div>
   <div id="projectbrief">Yet another WebKit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classYAWK_1_1update.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classYAWK_1_1update-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">YAWK\update Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The update class - handles yawk's system update functions.  
 <a href="classYAWK_1_1update.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a713e61c7cf6a00b559299ce5eea616e0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#a713e61c7cf6a00b559299ce5eea616e0">__construct</a> ()</td></tr>
<tr class="memdesc:a713e61c7cf6a00b559299ce5eea616e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">update constructor. Check if allow_url_fopen is enabled  <a href="classYAWK_1_1update.html#a713e61c7cf6a00b559299ce5eea616e0">More...</a><br /></td></tr>
<tr class="separator:a713e61c7cf6a00b559299ce5eea616e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc76d2665df45d415549177c9cf19ed1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#adc76d2665df45d415549177c9cf19ed1">generateLocalFilebase</a> (object $<a class="el" href="classYAWK_1_1db.html">db</a>, array $lang)</td></tr>
<tr class="memdesc:adc76d2665df45d415549177c9cf19ed1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read all files of current YaWK installation and write each file with path + MD5 hash to ini file to compare it later with the possible update files. This is used to verify the integrity of the files.  <a href="classYAWK_1_1update.html#adc76d2665df45d415549177c9cf19ed1">More...</a><br /></td></tr>
<tr class="separator:adc76d2665df45d415549177c9cf19ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3f8854a7461c829b55eeab4bde3c05b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#aa3f8854a7461c829b55eeab4bde3c05b">getUpdateSettings</a> ()</td></tr>
<tr class="memdesc:aa3f8854a7461c829b55eeab4bde3c05b"><td class="mdescLeft">&#160;</td><td class="mdescRight">get update settings from local update folder (system/update/update.ini) and return array|false  <a href="classYAWK_1_1update.html#aa3f8854a7461c829b55eeab4bde3c05b">More...</a><br /></td></tr>
<tr class="separator:aa3f8854a7461c829b55eeab4bde3c05b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a832caf961e7c253ef6193b8a5d6f3514"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#a832caf961e7c253ef6193b8a5d6f3514">isServerReachable</a> (string $url)</td></tr>
<tr class="memdesc:a832caf961e7c253ef6193b8a5d6f3514"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if update server is reachable  <a href="classYAWK_1_1update.html#a832caf961e7c253ef6193b8a5d6f3514">More...</a><br /></td></tr>
<tr class="separator:a832caf961e7c253ef6193b8a5d6f3514"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab97b21f02ad7f097392edd762bf9a0ce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#ab97b21f02ad7f097392edd762bf9a0ce">readUpdateFilebaseFromServer</a> ()</td></tr>
<tr class="memdesc:ab97b21f02ad7f097392edd762bf9a0ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">read filebase.ini from update server (<a href="https://update.yawk.io/filebase.ini">https://update.yawk.io/filebase.ini</a>) and return array|false  <a href="classYAWK_1_1update.html#ab97b21f02ad7f097392edd762bf9a0ce">More...</a><br /></td></tr>
<tr class="separator:ab97b21f02ad7f097392edd762bf9a0ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecd589d2997239070fdb1232b7845227"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#aecd589d2997239070fdb1232b7845227">readUpdateIniFromServer</a> ()</td></tr>
<tr class="memdesc:aecd589d2997239070fdb1232b7845227"><td class="mdescLeft">&#160;</td><td class="mdescRight">read update.ini from update server (<a href="https://update.yawk.io/update.ini">https://update.yawk.io/update.ini</a>) and return array|false  <a href="classYAWK_1_1update.html#aecd589d2997239070fdb1232b7845227">More...</a><br /></td></tr>
<tr class="separator:aecd589d2997239070fdb1232b7845227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7ced3b2e716f0b428a98ef1bb1cda55"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#ae7ced3b2e716f0b428a98ef1bb1cda55">runMigration</a> ($<a class="el" href="classYAWK_1_1db.html">db</a>)</td></tr>
<tr class="memdesc:ae7ced3b2e716f0b428a98ef1bb1cda55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the migration SQL file.  <a href="classYAWK_1_1update.html#ae7ced3b2e716f0b428a98ef1bb1cda55">More...</a><br /></td></tr>
<tr class="separator:ae7ced3b2e716f0b428a98ef1bb1cda55"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a2d1d0e5ee01f9eadef2f24a635b4f8d2"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#a2d1d0e5ee01f9eadef2f24a635b4f8d2">$base_dir</a> = ''</td></tr>
<tr class="separator:a2d1d0e5ee01f9eadef2f24a635b4f8d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00110cb586236bf3938e87cfe7453a16"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#a00110cb586236bf3938e87cfe7453a16">$localUpdateSystemPath</a> = 'system/<a class="el" href="classYAWK_1_1update.html">update</a>/'</td></tr>
<tr class="separator:a00110cb586236bf3938e87cfe7453a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfd9dbf0bb248aefefc1c7332fbc5cc4"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#abfd9dbf0bb248aefefc1c7332fbc5cc4">$updateFile</a> = 'update.ini'</td></tr>
<tr class="separator:abfd9dbf0bb248aefefc1c7332fbc5cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a824821ca300e8433f254d7271e51c90b"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#a824821ca300e8433f254d7271e51c90b">$updateFilebase</a> = 'filebase.ini'</td></tr>
<tr class="separator:a824821ca300e8433f254d7271e51c90b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3df607ed9e1832e917f67b0231ec5d3d"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#a3df607ed9e1832e917f67b0231ec5d3d">$updateServer</a> = 'https://update.yawk.io/'</td></tr>
<tr class="separator:a3df607ed9e1832e917f67b0231ec5d3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff6cc6512cd5ef44037ad7d0840d427a"><td class="memItemLeft" align="right" valign="top">array&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#aff6cc6512cd5ef44037ad7d0840d427a">$updateSettings</a> = array()</td></tr>
<tr class="separator:aff6cc6512cd5ef44037ad7d0840d427a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a0145d54ad6f93900e7bf64627d58c8"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classYAWK_1_1update.html#a7a0145d54ad6f93900e7bf64627d58c8">$updateVersion</a> = ''</td></tr>
<tr class="separator:a7a0145d54ad6f93900e7bf64627d58c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The update class - handles yawk's system update functions. </p>
<p>YaWK System Updater Class</p>
<p>The YaWK System Updater Class provides methods to facilitate the updating process of the system. It includes features such as checking for new versions, verifying and comparing files to ensure a stable and reliable update. This class aims to simplify the update process and minimize the risk of any errors or issues during the update.</p>
<dl class="section author"><dt>Author</dt><dd>Daniel Retzl <a href="#" onclick="location.href='mai'+'lto:'+'dan'+'ie'+'lre'+'tz'+'l@g'+'ma'+'il.'+'co'+'m'; return false;">danie<span style="display: none;">.nosp@m.</span>lret<span style="display: none;">.nosp@m.</span>zl@gm<span style="display: none;">.nosp@m.</span>ail.<span style="display: none;">.nosp@m.</span>com</a> </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>2009-2023 Daniel Retzl @license <a href="https://opensource.org/licenses/MIT">https://opensource.org/licenses/MIT</a> </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00017">17</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a713e61c7cf6a00b559299ce5eea616e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a713e61c7cf6a00b559299ce5eea616e0">&#9670;&nbsp;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">YAWK\update::__construct </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update constructor. Check if allow_url_fopen is enabled </p>
<p>will be called by xhr request from <a class="el" href="update-generateLocalFilebase_8php.html">admin/js/update-generateLocalFilebase.php</a> </p>

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00052">52</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <span class="comment">// Get the value of the allow_url_fopen setting</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            $allowUrlFopen = ini_get(<span class="stringliteral">&#39;allow_url_fopen&#39;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="comment">// Check if allow_url_fopen is enabled</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <span class="keywordflow">if</span> (!$allowUrlFopen)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            {   <span class="comment">// allow_url_fopen is disabled, exit with error</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                <span class="comment">// todo: syslog entry</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                echo <span class="stringliteral">&quot;allow_url_fopen is disabled, but required to use the update methods. Please enable allow_url_fopen in your php.ini file or ask your admin / hoster for assistance.&quot;</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <span class="comment">// check if update server is reachable</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classYAWK_1_1update.html#a832caf961e7c253ef6193b8a5d6f3514">isServerReachable</a>($this-&gt;updateServer.$this-&gt;updateFile) === <span class="keyword">false</span>)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            {   <span class="comment">// todo: syslog entry</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                echo <span class="stringliteral">&quot;Update server $this-&gt;updateServer not reachable. Update not possible at the moment - please try again later.&lt;br&gt;&quot;</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        }</div>
<div class="ttc" id="aclassYAWK_1_1update_html_a832caf961e7c253ef6193b8a5d6f3514"><div class="ttname"><a href="classYAWK_1_1update.html#a832caf961e7c253ef6193b8a5d6f3514">YAWK\update\isServerReachable</a></div><div class="ttdeci">isServerReachable(string $url)</div><div class="ttdoc">check if update server is reachable</div><div class="ttdef"><b>Definition:</b> <a href="system_2classes_2update_8php_source.html#l00076">update.php:76</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="system_2classes_2update_8php_source.html#l00076">YAWK\update\isServerReachable()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="adc76d2665df45d415549177c9cf19ed1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc76d2665df45d415549177c9cf19ed1">&#9670;&nbsp;</a></span>generateLocalFilebase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">YAWK\update::generateLocalFilebase </td>
          <td>(</td>
          <td class="paramtype">object&#160;</td>
          <td class="paramname"><em>$db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array&#160;</td>
          <td class="paramname"><em>$lang</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read all files of current YaWK installation and write each file with path + MD5 hash to ini file to compare it later with the possible update files. This is used to verify the integrity of the files. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$db</td><td>object global db object </td></tr>
    <tr><td class="paramname">$lang</td><td>array global language array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00259">259</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                                                      : <span class="keywordtype">void</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            $this-&gt;base_dir = dirname(__FILE__);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            $this-&gt;base_dir = substr($this-&gt;base_dir, 0, -15); <span class="comment">// remove last 15 chars</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="comment">// echo &quot;&lt;p&gt;Base directory: $this-&gt;base_dir&lt;/p&gt;&quot;;</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="comment">// set path and filename of the ini file</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            $updatePath = <span class="stringliteral">&#39;/system/update/&#39;</span>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            $updateFolder = $this-&gt;base_dir.$updatePath;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">if</span> (!is_dir($updateFolder)){</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="keywordflow">if</span> (!mkdir($updateFolder, 0777, <span class="keyword">true</span>) &amp;&amp; !is_dir($updateFolder)) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    <span class="keywordflow">throw</span> new \RuntimeException(sprintf(<span class="stringliteral">&#39;Unable to create &quot;%s&quot; - please check folder permissions or create folder by hand&#39;</span>, $updateFolder));</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            $iniFileName = <span class="stringliteral">&#39;filebase.current.ini&#39;</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            $input_folder = <a class="code" href="classYAWK_1_1update.html#a2d1d0e5ee01f9eadef2f24a635b4f8d2">$this-&gt;base_dir</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            $output_file = $updateFolder.$iniFileName;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            $writeIniFile = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="comment">// delete old file if exists</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">if</span> (is_file($output_file)){</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                unlink($output_file);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="comment">// Open the output file for writing</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            $output_handle = fopen($output_file, <span class="charliteral">&#39;w&#39;</span>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keywordflow">if</span> (!$output_handle) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="comment">// handle the error (e.g. show an error message or log the error)</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <a class="code" href="block-user_8php.html#aa0f42d43ba3cb9e178b944ee55e73a7c">die</a>(<span class="stringliteral">&quot;Failed to open file&quot;</span>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="comment">// Get the full path of the input folder</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            $input_folder = realpath($input_folder);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="comment">// Loop through all files in the input folder and its subfolders</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            echo <span class="stringliteral">&quot;&lt;p&gt;Building filebase of: &lt;i&gt;&lt;small&gt;$input_folder&lt;/small&gt;&lt;/i&gt;&lt;/p&gt;&quot;</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            $root_files = array();</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            $subfolder_files = array();</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">foreach</span>(<span class="keyword">new</span> \RecursiveIteratorIterator(<span class="keyword">new</span> \RecursiveDirectoryIterator($input_folder)) as $file_path)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                <span class="comment">// Skip some excluded directories and hidden files</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <span class="keywordflow">if</span> ($file_path-&gt;isDir()</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                    || $file_path-&gt;getFilename()[0] == <span class="charliteral">&#39;.&#39;</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    || strpos($file_path, <span class="stringliteral">&#39;/.git/&#39;</span>) !== <span class="keyword">false</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    || strpos($file_path, <span class="stringliteral">&#39;/.github/&#39;</span>) !== <span class="keyword">false</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    || strpos($file_path, <span class="stringliteral">&#39;/.idea/&#39;</span>) !== <span class="keyword">false</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    || strpos($file_path, <span class="stringliteral">&#39;/content/&#39;</span>) !== <span class="keyword">false</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    || strpos($file_path, <span class="stringliteral">&#39;/media/&#39;</span>) !== <span class="keyword">false</span>)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                {   <span class="comment">// skip this file/folder</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                <span class="comment">// Calculate the MD5 hash of the file</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                $md5_hash = md5_file($file_path);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                <span class="comment">// Get the full path of the file</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                $full_path = realpath($file_path);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="comment">// Remove the input folder path from the full path to get the relative path</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                $relative_path = substr($full_path, strlen($input_folder) + 1);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <span class="comment">// Split the relative path into an array of path components</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                $path_components = explode(<span class="charliteral">&#39;/&#39;</span>, $relative_path);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <span class="comment">// Check if the path has only one component (i.e. it&#39;s a file in the root folder)</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keywordflow">if</span> (count($path_components) == 1) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    $root_files[$relative_path] = $md5_hash;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    $subfolder_files[$relative_path] = $md5_hash;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="comment">// Sort the arrays alphabetically by key (the relative path)</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            ksort($root_files);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            ksort($subfolder_files);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="comment">// Merge the two arrays so that the root files are listed first</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            $hashes = array_merge($root_files, $subfolder_files);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="comment">// init counters</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            $totalFiles = count($hashes);   <span class="comment">// count total files</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            $totalFilesVerified = 0;        <span class="comment">// number of verified files</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            $totalFilesFailed = 0;          <span class="comment">// number of failed files</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="comment">// Write the sorted array to the output file in the .ini format</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keywordflow">foreach</span> ($hashes as $relative_path =&gt; $md5_hash)</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            {   <span class="comment">// write each file with its md5 hash to ini file</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="comment">// echo &quot;Writing $relative_path=$md5_hash to $output_file\n&quot;;</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="comment">// Write the relative path and MD5 hash to the output file</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keywordflow">if</span> (file_put_contents($output_file, <span class="stringliteral">&quot;$relative_path=$md5_hash\n&quot;</span>, FILE_APPEND))</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                {   <span class="comment">// line written successfully</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    <span class="comment">// echo &#39;&lt;p class=&quot;text-success&quot;&gt;Verified &#39;.$relative_path.&#39; &lt;small&gt;&#39;.$md5_hash.&#39;&lt;/small&gt;&lt;/p&gt;&#39;;</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    $totalFilesVerified++;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                {   <span class="comment">// line failed</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    <span class="comment">// echo &#39;&lt;p class=&quot;text-danger&quot;&gt;Failed &#39;.$relative_path.&#39; &lt;small&gt;&#39;.$md5_hash.&#39;&lt;/small&gt;&lt;/p&gt;&#39;;</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    $totalFilesFailed++;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="comment">// Close the output file</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            echo <span class="stringliteral">&#39;&lt;p class=&quot;animated fadeIn slow delay-1s&quot;&gt;Indexing &lt;b&gt;&#39;</span>.$totalFiles.<span class="stringliteral">&#39;&lt;/b&gt; files. Verified &lt;b&gt;&#39;</span>.$totalFilesVerified.<span class="stringliteral">&#39;&lt;/b&gt; files. Failed &lt;b&gt;&#39;</span>.$totalFilesFailed.<span class="stringliteral">&#39;&lt;/b&gt; files.&lt;/p&gt;&#39;</span>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keywordflow">if</span> (!is_file($output_file))</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            {   <span class="comment">// unable to write ini file</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                $iniFileWritten = <span class="stringliteral">&quot;&lt;h4 class=\&quot;text-danger\&quot;&gt;&quot;</span>.$iniFileName.<span class="stringliteral">&quot; could not be written&lt;/h4&gt;&quot;</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            {   <span class="comment">// ini file written successfully</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                $iniFileWritten = <span class="stringliteral">&quot;&lt;p class=\&quot;animated fadeIn slow delay-5s\&quot;&gt;Hash values written to: &lt;b&gt;&lt;a href=\&quot;$updatePath$iniFileName\&quot; target=\&quot;_blank\&quot;&gt;$updatePath$iniFileName&lt;/a&gt;&lt;/b&gt;&lt;/p&gt;&quot;</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <span class="comment">// check if all files were verified</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="keywordflow">if</span> ($totalFiles == $totalFilesVerified)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            {   <span class="comment">// set success icon, message and colors</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                $icon = <span class="stringliteral">&#39;&lt;i class=&quot;fa fa-check-circle-o fa-2x text-success&quot;&gt;&lt;/i&gt;&#39;</span>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                $done = <span class="stringliteral">&quot;&lt;h4 class=\&quot;text-success animated fadeIn slow delay-4s\&quot;&gt;&quot;</span>.$totalFiles.<span class="stringliteral">&quot;&amp;nbsp;&quot;</span>.<a class="code" href="admin_2includes_2filemanager_8php.html#aa5ed3346b5437107e83ab49e3e311acb">$lang</a>[<span class="stringliteral">&#39;UPDATE_VERIFICATION_SUCCESS&#39;</span>].<span class="stringliteral">&quot;&lt;/h4&gt;&quot;</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                $iconFalse = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                $successColor = <span class="stringliteral">&#39; text-success&#39;</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                $failedColor = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            {   <span class="comment">// set failure icon, message and colors</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                $iconFalse = <span class="stringliteral">&#39;&lt;i class=&quot;fa fa-exclamation-triangle fa-2x text-danger&quot;&gt;&lt;/i&gt;&#39;</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                $done = <span class="stringliteral">&quot;&lt;h4 class=\&quot;text-danger\&quot;&gt;&lt;b&gt;&quot;</span>.$totalFilesFailed.<span class="stringliteral">&quot; &quot;</span>.<a class="code" href="admin_2includes_2filemanager_8php.html#aa5ed3346b5437107e83ab49e3e311acb">$lang</a>[<span class="stringliteral">&#39;UPDATE_VERIFICATION_FAILED&#39;</span>].<span class="stringliteral">&quot;&lt;/b&gt;&lt;/h4&gt;&quot;</span>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                $failedColor = <span class="stringliteral">&#39; text-danger&#39;</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                $successColor = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            echo <span class="stringliteral">&quot;</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="stringliteral">&lt;p class=\&quot;animated fadeIn slow delay-2s$successColor\&quot;&gt;$icon &amp;nbsp;Generated hash values: &lt;b&gt;$totalFilesVerified / $totalFiles&lt;/b&gt;&lt;/p&gt;</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="stringliteral">&lt;h4 class=\&quot;animated fadeIn slow delay-3s\&quot;&gt;$done&lt;/h4&gt;</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="stringliteral">&lt;p class=\&quot;animated fadeIn slow delay-4s$failedColor\&quot;&gt;$iconFalse &amp;nbsp;Failed to verify: &lt;b&gt;$totalFilesFailed&lt;/b&gt;&lt;/p&gt;</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="stringliteral">$iniFileWritten&quot;</span>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="comment">// Close the output file</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">if</span> (!fclose($output_handle)){</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                echo <span class="stringliteral">&#39;&lt;p class=&quot;animated fadeIn slow delay-5s&quot;&gt;failed to close: &#39;</span>.$updateFolder.$iniFileName.<span class="stringliteral">&#39;&lt;/p&gt;&#39;</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        }</div>
<div class="ttc" id="aadmin_2includes_2filemanager_8php_html_aa5ed3346b5437107e83ab49e3e311acb"><div class="ttname"><a href="admin_2includes_2filemanager_8php.html#aa5ed3346b5437107e83ab49e3e311acb">$lang</a></div><div class="ttdeci">print $lang['FILEMAN_UPLOAD']</div><div class="ttdef"><b>Definition:</b> <a href="admin_2includes_2filemanager_8php_source.html#l00369">filemanager.php:369</a></div></div>
<div class="ttc" id="ablock-user_8php_html_aa0f42d43ba3cb9e178b944ee55e73a7c"><div class="ttname"><a href="block-user_8php.html#aa0f42d43ba3cb9e178b944ee55e73a7c">die</a></div><div class="ttdeci">die</div><div class="ttdef"><b>Definition:</b> <a href="block-user_8php_source.html#l00027">block-user.php:27</a></div></div>
<div class="ttc" id="aclassYAWK_1_1update_html_a2d1d0e5ee01f9eadef2f24a635b4f8d2"><div class="ttname"><a href="classYAWK_1_1update.html#a2d1d0e5ee01f9eadef2f24a635b4f8d2">YAWK\update\$base_dir</a></div><div class="ttdeci">string $base_dir</div><div class="ttdef"><b>Definition:</b> <a href="system_2classes_2update_8php_source.html#l00020">update.php:20</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="system_2classes_2update_8php_source.html#l00020">YAWK\update\$base_dir</a>, <a class="el" href="admin_2includes_2filemanager_8php_source.html#l00369">$lang</a>, and <a class="el" href="block-user_8php_source.html#l00027">die</a>.</p>

</div>
</div>
<a id="aa3f8854a7461c829b55eeab4bde3c05b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3f8854a7461c829b55eeab4bde3c05b">&#9670;&nbsp;</a></span>getUpdateSettings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">YAWK\update::getUpdateSettings </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get update settings from local update folder (system/update/update.ini) and return array|false </p>
<p>will be called by xhr request from <a class="el" href="update-generateLocalFilebase_8php.html">admin/js/update-generateLocalFilebase.php</a> </p><dl class="section return"><dt>Returns</dt><dd>array|false </dd></dl>

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00104">104</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                           : array|<span class="keyword">false</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="comment">// read update.ini from local update folder</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            $this-&gt;updateSettings = parse_ini_file($this-&gt;localUpdateSystemPath.$this-&gt;updateFile);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keywordflow">if</span> (count($this-&gt;updateSettings) &lt; 1)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            {   <span class="comment">// unable to read update.ini from local update folder</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                echo <span class="stringliteral">&quot;Error: Unable to read update.ini from local update folder. Check if this file exists: &quot;</span>.$this-&gt;localUpdateSystemPath.$this-&gt;updateFile;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <span class="comment">// update.ini read successfully</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <span class="comment">// set update version</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                $this-&gt;updateVersion = $this-&gt;updateSettings[<span class="stringliteral">&#39;version&#39;</span>];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <span class="comment">// return update settings array</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="classYAWK_1_1update.html#aff6cc6512cd5ef44037ad7d0840d427a">$this-&gt;updateSettings</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="comment">// return false if something went wrong</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        }</div>
<div class="ttc" id="aclassYAWK_1_1update_html_aff6cc6512cd5ef44037ad7d0840d427a"><div class="ttname"><a href="classYAWK_1_1update.html#aff6cc6512cd5ef44037ad7d0840d427a">YAWK\update\$updateSettings</a></div><div class="ttdeci">array $updateSettings</div><div class="ttdef"><b>Definition:</b> <a href="system_2classes_2update_8php_source.html#l00046">update.php:46</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="system_2classes_2update_8php_source.html#l00046">YAWK\update\$updateSettings</a>.</p>

</div>
</div>
<a id="a832caf961e7c253ef6193b8a5d6f3514"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a832caf961e7c253ef6193b8a5d6f3514">&#9670;&nbsp;</a></span>isServerReachable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">YAWK\update::isServerReachable </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>$url</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check if update server is reachable </p>
<p>returns true if server is reachable, false if not </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$url</td><td>string url to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool true|false </dd></dl>

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00076">76</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                                      : <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            $ch = curl_init(<a class="code" href="user-new_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            curl_setopt($ch, CURLOPT_NOBODY, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            curl_setopt($ch, CURLOPT_TIMEOUT, 30);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            curl_setopt($ch, CURLOPT_USERAGENT, <span class="stringliteral">&#39;Mozilla/5.0 (compatible; UpdateClient/1.0)&#39;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            $response = curl_exec($ch);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            curl_close($ch);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keywordflow">if</span> ($httpCode &gt;= 200 &amp;&amp; $httpCode &lt; 300) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        }</div>
<div class="ttc" id="auser-new_8php_html_acf215f34a917d014776ce684a9ee8909"><div class="ttname"><a href="user-new_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a></div><div class="ttdeci">$url</div><div class="ttdef"><b>Definition:</b> <a href="user-new_8php_source.html#l00101">user-new.php:101</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="user-new_8php_source.html#l00101">$url</a>.</p>

<p class="reference">Referenced by <a class="el" href="system_2classes_2update_8php_source.html#l00052">YAWK\update\__construct()</a>.</p>

</div>
</div>
<a id="ab97b21f02ad7f097392edd762bf9a0ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab97b21f02ad7f097392edd762bf9a0ce">&#9670;&nbsp;</a></span>readUpdateFilebaseFromServer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">YAWK\update::readUpdateFilebaseFromServer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read filebase.ini from update server (<a href="https://update.yawk.io/filebase.ini">https://update.yawk.io/filebase.ini</a>) and return array|false </p>
<p>will be called by xhr request from <a class="el" href="update-readUpdateFilebase_8php.html">admin/js/update-readUpdateFilebase.php</a> The filebase.ini contains a list of all files with their md5 hash. This function returns the filebase as array. (to compare it later with the local filebase) </p><dl class="section return"><dt>Returns</dt><dd>array|false </dd></dl>

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00131">131</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                      : <span class="keyword">false</span>|array</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="comment">// URL of the remote INI file</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <a class="code" href="user-new_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a> = $this-&gt;updateServer.<span class="stringliteral">&#39;filebase.ini&#39;</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="comment">// Get the content of the remote INI file</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            $iniContent = file_get_contents(<a class="code" href="user-new_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="comment">// Check if the content was retrieved successfully</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordflow">if</span> ($iniContent !== <span class="keyword">false</span>)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            {   <span class="comment">// Parse the INI content into an associative array</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                $filebase = parse_ini_string($iniContent);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <span class="comment">// Print the contents of the array</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="keywordflow">foreach</span> ($filebase as $key =&gt; <a class="code" href="widget-edit_8php.html#a0f298096f322952a72a50f98a74c7b60">$value</a>)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                {   <span class="comment">// set update array</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                    <a class="code" href="classYAWK_1_1update.html#a824821ca300e8433f254d7271e51c90b">$updateFilebase</a>[$key] = <a class="code" href="widget-edit_8php.html#a0f298096f322952a72a50f98a74c7b60">$value</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            {   <span class="comment">// unable to read filebase from remote server</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                echo <span class="stringliteral">&quot;Error: Unable to read filebase from remote server. Check if this file exists: $url&quot;</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="comment">// return array or false</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classYAWK_1_1update.html#a824821ca300e8433f254d7271e51c90b">$updateFilebase</a> ?? <span class="keyword">false</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        }</div>
<div class="ttc" id="aclassYAWK_1_1update_html_a824821ca300e8433f254d7271e51c90b"><div class="ttname"><a href="classYAWK_1_1update.html#a824821ca300e8433f254d7271e51c90b">YAWK\update\$updateFilebase</a></div><div class="ttdeci">string $updateFilebase</div><div class="ttdef"><b>Definition:</b> <a href="system_2classes_2update_8php_source.html#l00041">update.php:41</a></div></div>
<div class="ttc" id="awidget-edit_8php_html_a0f298096f322952a72a50f98a74c7b60"><div class="ttname"><a href="widget-edit_8php.html#a0f298096f322952a72a50f98a74c7b60">$value</a></div><div class="ttdeci">$value</div><div class="ttdef"><b>Definition:</b> <a href="widget-edit_8php_source.html#l00244">widget-edit.php:244</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="system_2classes_2update_8php_source.html#l00041">YAWK\update\$updateFilebase</a>, <a class="el" href="user-new_8php_source.html#l00101">$url</a>, and <a class="el" href="widget-edit_8php_source.html#l00244">$value</a>.</p>

</div>
</div>
<a id="aecd589d2997239070fdb1232b7845227"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecd589d2997239070fdb1232b7845227">&#9670;&nbsp;</a></span>readUpdateIniFromServer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">YAWK\update::readUpdateIniFromServer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read update.ini from update server (<a href="https://update.yawk.io/update.ini">https://update.yawk.io/update.ini</a>) and return array|false </p>
<dl class="section return"><dt>Returns</dt><dd>false|array </dd></dl>

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00226">226</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                                 : <span class="keyword">false</span>|array</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="comment">// URL of the remote INI file</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <a class="code" href="user-new_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a> = $this-&gt;updateServer.$this-&gt;updateFile;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="comment">// Get the content of the remote INI file</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            $iniContent = file_get_contents(<a class="code" href="user-new_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="comment">// Check if the content was retrieved successfully</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordflow">if</span> ($iniContent !== <span class="keyword">false</span>)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            {   <span class="comment">// Parse the INI content into an associative array</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                $config = parse_ini_string($iniContent);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="comment">// Print the contents of the array</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="keywordflow">foreach</span> ($config as $key =&gt; <a class="code" href="widget-edit_8php.html#a0f298096f322952a72a50f98a74c7b60">$value</a>)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                {   <span class="comment">// set update array</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                    $updateConfig[<span class="stringliteral">&#39;UPDATE&#39;</span>][$key] = <a class="code" href="widget-edit_8php.html#a0f298096f322952a72a50f98a74c7b60">$value</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            {   <span class="comment">// unable to read update.ini from remote server</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                echo <span class="stringliteral">&quot;Error: Unable to read the remote INI file.&quot;</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keywordflow">return</span> $updateConfig ?? <span class="keyword">false</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="user-new_8php_source.html#l00101">$url</a>, and <a class="el" href="widget-edit_8php_source.html#l00244">$value</a>.</p>

</div>
</div>
<a id="ae7ced3b2e716f0b428a98ef1bb1cda55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ced3b2e716f0b428a98ef1bb1cda55">&#9670;&nbsp;</a></span>runMigration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">YAWK\update::runMigration </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$db</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the migration SQL file. </p>
<p>if update.ini contains a migration file, this function will be called </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$db</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00164">164</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                  : <span class="keywordtype">void</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="comment">// build migration SQL file string</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            $migrationUrl = $this-&gt;updateServer.$this-&gt;updateVersion.<span class="stringliteral">&#39;-migration.sql&#39;</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="comment">// Fetch the migration SQL file</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            $migrationSql = file_get_contents($migrationUrl);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">if</span> ($migrationSql === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                echo <span class="stringliteral">&quot;Error: Unable to fetch migration file from $migrationUrl\n&quot;</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="comment">// Check if the migration has already been executed</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            $checkMigration = <a class="code" href="dismiss-notifications_8php.html#a1fa3127fc82f96b1436d871ef02be319">$db</a>-&gt;prepare(<span class="stringliteral">&quot;SELECT `version` FROM `migrations` WHERE `version` = ?&quot;</span>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            $checkMigration-&gt;bind_param(<span class="charliteral">&#39;s&#39;</span>, $this-&gt;updateVersion);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            $checkMigration-&gt;execute();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <a class="code" href="email-send_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = $checkMigration-&gt;get_result();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="email-send_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>-&gt;num_rows === 0) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="comment">// Execute the migration SQL</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="dismiss-notifications_8php.html#a1fa3127fc82f96b1436d871ef02be319">$db</a>-&gt;multi_query($migrationSql)) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    <span class="comment">// Record the successful migration</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                    $insertMigration = <a class="code" href="dismiss-notifications_8php.html#a1fa3127fc82f96b1436d871ef02be319">$db</a>-&gt;prepare(<span class="stringliteral">&quot;INSERT INTO `migrations` (`version`, `executed_at`) VALUES (?, NOW())&quot;</span>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    $insertMigration-&gt;bind_param(<span class="charliteral">&#39;s&#39;</span>, $this-&gt;updateVersion);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                    <span class="comment">// execute update migration</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                    <span class="keywordflow">if</span> ($insertMigration-&gt;execute())</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    {   <span class="comment">// migration executed successfully</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                        <span class="comment">// todo: syslog entry</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                        echo <span class="stringliteral">&quot;Migration for version $this-&gt;updateVersion executed successfully.\n&quot;</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                    }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                    {   <span class="comment">// migration failed</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                        <span class="comment">// todo: syslog entry</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                        echo <span class="stringliteral">&quot;Error recording migration for version $this-&gt;updateVersion: &quot;</span> . $insertMigration-&gt;error . <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                    }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                    <span class="comment">// close insert migration connection</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    $insertMigration-&gt;close();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                {   <span class="comment">// migration failed</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    <span class="comment">// todo: syslog entry</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    echo <span class="stringliteral">&quot;Error executing migration for version $this-&gt;updateVersion: &quot;</span> . <a class="code" href="dismiss-notifications_8php.html#a1fa3127fc82f96b1436d871ef02be319">$db</a>-&gt;error . <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            {   <span class="comment">// migration already executed</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="comment">// todo: syslog entry</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                echo <span class="stringliteral">&quot;Migration for version $this-&gt;updateVersion already executed.\n&quot;</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="comment">// close check migration connection</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            $checkMigration-&gt;close();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="ttc" id="adismiss-notifications_8php_html_a1fa3127fc82f96b1436d871ef02be319"><div class="ttname"><a href="dismiss-notifications_8php.html#a1fa3127fc82f96b1436d871ef02be319">$db</a></div><div class="ttdeci">$db</div><div class="ttdef"><b>Definition:</b> <a href="dismiss-notifications_8php_source.html#l00004">dismiss-notifications.php:4</a></div></div>
<div class="ttc" id="aemail-send_8php_html_a112ef069ddc0454086e3d1e6d8d55d07"><div class="ttname"><a href="email-send_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a></div><div class="ttdeci">$result</div><div class="ttdef"><b>Definition:</b> <a href="email-send_8php_source.html#l00137">email-send.php:137</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="dismiss-notifications_8php_source.html#l00004">$db</a>, and <a class="el" href="email-send_8php_source.html#l00137">$result</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a2d1d0e5ee01f9eadef2f24a635b4f8d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d1d0e5ee01f9eadef2f24a635b4f8d2">&#9670;&nbsp;</a></span>$base_dir</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string YAWK\update::$base_dir = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00020">20</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="system_2classes_2update_8php_source.html#l00259">YAWK\update\generateLocalFilebase()</a>.</p>

</div>
</div>
<a id="a00110cb586236bf3938e87cfe7453a16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00110cb586236bf3938e87cfe7453a16">&#9670;&nbsp;</a></span>$localUpdateSystemPath</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string YAWK\update::$localUpdateSystemPath = 'system/<a class="el" href="classYAWK_1_1update.html">update</a>/'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00036">36</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>

</div>
</div>
<a id="abfd9dbf0bb248aefefc1c7332fbc5cc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfd9dbf0bb248aefefc1c7332fbc5cc4">&#9670;&nbsp;</a></span>$updateFile</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string YAWK\update::$updateFile = 'update.ini'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00026">26</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>

</div>
</div>
<a id="a824821ca300e8433f254d7271e51c90b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a824821ca300e8433f254d7271e51c90b">&#9670;&nbsp;</a></span>$updateFilebase</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string YAWK\update::$updateFilebase = 'filebase.ini'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00041">41</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="system_2classes_2update_8php_source.html#l00131">YAWK\update\readUpdateFilebaseFromServer()</a>.</p>

</div>
</div>
<a id="a3df607ed9e1832e917f67b0231ec5d3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3df607ed9e1832e917f67b0231ec5d3d">&#9670;&nbsp;</a></span>$updateServer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string YAWK\update::$updateServer = 'https://update.yawk.io/'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00023">23</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>

</div>
</div>
<a id="aff6cc6512cd5ef44037ad7d0840d427a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff6cc6512cd5ef44037ad7d0840d427a">&#9670;&nbsp;</a></span>$updateSettings</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">array YAWK\update::$updateSettings = array()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00046">46</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="system_2classes_2update_8php_source.html#l00104">YAWK\update\getUpdateSettings()</a>.</p>

</div>
</div>
<a id="a7a0145d54ad6f93900e7bf64627d58c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a0145d54ad6f93900e7bf64627d58c8">&#9670;&nbsp;</a></span>$updateVersion</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string YAWK\update::$updateVersion = ''</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="system_2classes_2update_8php_source.html#l00031">31</a> of file <a class="el" href="system_2classes_2update_8php_source.html">update.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/var/www/htdocs/yawk.io/system/classes/<a class="el" href="system_2classes_2update_8php_source.html">update.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceYAWK.html">YAWK</a></li><li class="navelem"><a class="el" href="classYAWK_1_1update.html">update</a></li>
    <li class="footer">Generated on Sat Mar 25 2023 16:13:37 for YaWK by <small>doxygen 1.9.1</small></li>
  </ul>
</div>
</body>
</html>
